<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/logo.png">
    <title>PIERO AI PREMIER</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- ESTILOS BASE --- */
        *{box-sizing:border-box;margin:0;padding:0;}
        body{
            font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background:#0a0a0a;
            color:white;
            transition:0.3s;
        }
        body.light{ background:#f5f5f5; color:#111; }

        /* --- HEADER CON ANIMACIÃ“N DE ESTRELLAS --- */
        .header-box{
            width:100%;
            height:25vh;
            background: linear-gradient(135deg,#1f1c2c,#928dab);
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            font-family: 'Montserrat', sans-serif;
            font-size:6vh;
            font-weight:700;
            letter-spacing:2px;
            color:#ffffff;
            text-align:center;
            position:relative;
            overflow:hidden;
            transition: transform 0.3s;
            cursor:pointer;
        }
        .header-box:hover{ transform: scale(1.02); }
        .header-box::before{
            content:"";
            position:absolute;
            top:0; left:0; width:200%; height:200%;
            background:transparent url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><circle cx="10" cy="10" r="1.2" fill="%23ffffff"/><circle cx="50" cy="80" r="0.8" fill="%23ffffff"/><circle cx="120" cy="40" r="1.5" fill="%23ffffff"/><circle cx="170" cy="150" r="1" fill="%23ffffff"/><circle cx="60" cy="160" r="0.7" fill="%23ffffff"/><circle cx="180" cy="20" r="1.2" fill="%23ffffff"/><circle cx="90" cy="110" r="1" fill="%23ffffff"/><circle cx="30" cy="60" r="1.3" fill="%23ffffff"/><circle cx="140" cy="90" r="0.9" fill="%23ffffff"/><circle cx="20" cy="140" r="1.1" fill="%23ffffff"/></svg>') repeat;
            animation: moveStars 60s linear infinite;
            opacity:0.5;
            pointer-events:none;
        }
        .header-box:hover::before{ animation: moveStarsHover 10s linear infinite; }
        @keyframes moveStars{ from{transform:translate(0,0);} to{transform:translate(-100px,-100px);} }
        @keyframes moveStarsHover{ from{transform:translate(0,0);} to{transform:translate(-200px,-200px);} }

        /* --- DESCRIPCIÃ“N --- */
        .description{
            text-align:center;
            font-family:'Poppins', sans-serif;
            font-size:1em;
            margin:40px auto 50px auto;
            color:#fff;
            max-width:800px;
            padding: 0 20px;
        }
        body.light .description{ color:#111; }

        /* --- INTERRUPTORES --- */
        .switches{
            position:fixed;
            top:15px;
            width:100%;
            display:flex;
            justify-content:space-between;
            padding:0 20px;
            z-index:100;
        }
        .switch{
            display:flex;
            align-items:center;
            font-weight:bold;
            cursor:pointer;
            font-size:0.9em;
            color:white !important;
        }
        .switch input{display:none;}
        .slider{
            width:30px;height:16px;
            background:#555;border-radius:34px;
            margin-left:8px;position:relative;transition:0.4s;
        }
        .slider::before{
            content:"";
            position:absolute;width:12px;height:12px;
            left:2px;bottom:2px;background:white;border-radius:50%;transition:0.4s;
        }
        input:checked + .slider{background:#00d2ff;}
        input:checked + .slider::before{transform:translateX(14px);}

        /* --- CONTENEDORES --- */
        .main-container{
            display:flex;
            justify-content:center;
            gap:20px;
            margin-top:20px;
            padding:0 20px;
            flex-wrap:wrap;
        }
        .video-box{
            flex:1;
            min-width:320px;
            border-radius:15px;
            padding:15px;
            display:flex;
            flex-direction:column;
            align-items:center;
            position:relative;
            overflow:hidden;
            transition:0.3s, box-shadow 0.3s;
            background:#222;
        }
        body.light .video-box{ background:#ccc; }
        .video-box h3{margin-bottom:15px; z-index:10;}
        .video-box video{
            width:100%;
            border-radius:10px;
            max-height:60vh;
            object-fit:contain;
            background: #000;
        }

        /* --- BOTONES --- */
        .upload-btn, .process-btn, #downloadBtn {
            padding:12px 25px;
            border:none;
            border-radius:25px;
            font-weight:bold;
            cursor:pointer;
            transition:0.3s;
            z-index:10;
        }
        .upload-btn{ background:#333; color:white; margin-top:10px; }
        .upload-btn:hover{ transform:scale(1.05); box-shadow:0 0 15px rgba(255,255,255,0.1); }
        
        .process-btn{
            margin:40px auto;
            display:block;
            padding:15px 40px;
            background:#222;
            color:white;
            font-size:18px;
        }
        .process-btn:hover:not(:disabled){
            transform:scale(1.05);
            box-shadow:0 0 20px rgba(100,100,100,0.4);
        }
        
        #cancelBtn{ background:#aa2222 !important; margin-top:10px; }

        #downloadBtn{
            display:none;
            margin-top:15px;
            background:#00d2ff;
            color:#000;
            width: 80%;
        }
        #downloadBtn:hover{ transform:scale(1.03); box-shadow:0 0 15px rgba(0,210,255,0.5); }

        /* --- CARGA --- */
        .loading-overlay{
            position:absolute;
            top:0; left:0; width:100%; height:100%;
            background: rgba(10,10,10,0.6);
            display:none;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            backdrop-filter: blur(4px);
            z-index:5;
        }
        .circle-loader{
            width:50px;height:50px;
            border:5px solid #fff;
            border-top:5px solid #00d2ff;
            border-radius:50%;
            animation:spin 1s linear infinite;
        }
        @keyframes spin{to{transform:rotate(360deg);}}

        footer{ text-align:center; margin:40px 0 20px 0; color:#aaa; font-size:0.9em; }
    </style>
</head>
<body>

<div class="switches">
    <label class="switch"><span id="darkEmoji">ðŸŒ™</span>
        <input type="checkbox" id="darkSwitch">
        <span class="slider"></span>
    </label>
    <label class="switch">EN/ES
        <input type="checkbox" id="langSwitch">
        <span class="slider"></span>
    </label>
</div>

<div class="header-box" id="title">PIERO AI PREMIER</div>

<div class="description" id="descriptionText">Piero AI Premier uses advanced AI to upscale your videos to 4K quickly. Upload your MP4 file or drag it into the box labeled <strong>Original Video</strong>.</div>

<div class="main-container">
    <div class="video-box" id="dropOriginal">
        <h3 id="labelOriginal">Original Video</h3>
        <video id="videoOriginal" controls style="display:none;"></video>
        <button class="upload-btn" id="uploadBtn">Upload Video</button>
        <button class="upload-btn" id="cancelBtn" style="display:none;">Cancel</button>
        <input type="file" id="videoInput" accept="video/mp4" style="display:none;">
    </div>

    <div class="video-box" id="drop4k">
        <h3 id="label4k">4K Video</h3>
        <div class="loading-overlay" id="loadingOverlay">
            <div class="circle-loader"></div>
            <div id="progressText" style="margin-top:10px;">Processing...</div>
        </div>
        <video id="video4k" controls style="display:none;"></video>
        <button id="downloadBtn">Download 4K Video</button>
    </div>
</div>

<button class="process-btn" id="processBtn">Scale to 4K</button>

<footer id="footerText">Created by Piero Pacheco Â© 2026</footer>

<script>
    const darkSwitch = document.getElementById("darkSwitch");
    const darkEmoji = document.getElementById("darkEmoji");
    const langSwitch = document.getElementById("langSwitch");
    const uploadBtn = document.getElementById("uploadBtn");
    const cancelBtn = document.getElementById("cancelBtn");
    const videoInput = document.getElementById("videoInput");
    const videoOriginal = document.getElementById("videoOriginal");
    const processBtn = document.getElementById("processBtn");
    const video4k = document.getElementById("video4k");
    const loadingOverlay = document.getElementById("loadingOverlay");
    const descriptionText = document.getElementById("descriptionText");
    const downloadBtn = document.getElementById("downloadBtn");
    const labelOriginal = document.getElementById("labelOriginal");
    const label4k = document.getElementById("label4k");
    const footerText = document.getElementById("footerText");

    // DARK MODE
    darkSwitch.addEventListener("change", ()=>{
        document.body.classList.toggle("light", darkSwitch.checked);
        darkEmoji.textContent = darkSwitch.checked ? "â˜€ï¸" : "ðŸŒ™";
    });

    // IDIOMA (Incluye Footer y Etiquetas de Video)
    langSwitch.addEventListener("change", ()=>{
        const es = langSwitch.checked;
        processBtn.textContent = es ? "Escalar a 4K" : "Scale to 4K";
        uploadBtn.textContent = es ? "Subir Video" : "Upload Video";
        cancelBtn.textContent = es ? "Cancelar" : "Cancel";
        labelOriginal.textContent = es ? "Video Original" : "Original Video";
        label4k.textContent = es ? "Video 4K" : "4K Video";
        downloadBtn.textContent = es ? "Descargar Video 4K" : "Download 4K Video";
        footerText.textContent = es ? "Creado por Piero Pacheco Â© 2026" : "Created by Piero Pacheco Â© 2026";
        
        descriptionText.innerHTML = es ? 
            "Piero AI Premier utiliza IA avanzada para escalar tus videos a 4K rÃ¡pidamente. Sube tu archivo MP4 o arrÃ¡stralo al recuadro con el nombre <strong>Video Original</strong>." : 
            "Piero AI Premier uses advanced AI to upscale your videos to 4K quickly. Upload your MP4 file or drag it into the box labeled <strong>Original Video</strong>.";
    });

    // MANEJO DE ARCHIVOS
    function handleFile(file){
        if(file){
            videoOriginal.src = URL.createObjectURL(file);
            videoOriginal.style.display="block";
            uploadBtn.style.display="none";
            cancelBtn.style.display="block";
            const dt = new DataTransfer();
            dt.items.add(file);
            videoInput.files = dt.files;
        }
    }

    uploadBtn.addEventListener("click", ()=>videoInput.click());
    videoInput.addEventListener("change", ()=> handleFile(videoInput.files[0]));
    cancelBtn.addEventListener("click", ()=> location.reload());

    // PROCESAR
    processBtn.addEventListener("click", async()=>{
        const file = videoInput.files[0];
        if(!file) return alert(langSwitch.checked ? "Sube un video" : "Upload a video");

        processBtn.disabled = true;
        loadingOverlay.style.display = "flex";
        video4k.style.display = "none";
        downloadBtn.style.display = "none";

        const fd = new FormData();
        fd.append("file", file);

        try {
            const res = await fetch("/upscale", { method: "POST", body: fd });
            const data = await res.json();

            if(data.video_url){
                const url = window.location.origin + data.video_url;
                video4k.src = url;
                video4k.style.display = "block";
                video4k.load();
                downloadBtn.style.display = "block";
                downloadBtn.onclick = () => {
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = "PieroAI_4K.mp4";
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                };
            } else {
                alert("Error: " + data.error);
            }
        } catch (e) {
            alert("Error de conexiÃ³n");
        } finally {
            loadingOverlay.style.display = "none";
            processBtn.disabled = false;
        }
    });

    document.getElementById("title").addEventListener("click", () => location.reload());
</script>
</body>
</html>